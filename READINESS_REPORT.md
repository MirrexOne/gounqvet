# üìä –ü–û–õ–ù–´–ô –û–¢–ß–ï–¢ –ì–û–¢–û–í–ù–û–°–¢–ò SQLVET –ö PR –í GOLANGCI-LINT

**–î–∞—Ç–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏:** 2024-11-25  
**–í–µ—Ä—Å–∏—è:** v1.0.0  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ì–û–¢–û–í –ö PR (–ø–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è Go –≤–µ—Ä—Å–∏–∏)

## üîç –î–ï–¢–ê–õ–¨–ù–ê–Ø –ü–†–û–í–ï–†–ö–ê –í–°–ï–• –¢–†–ï–ë–û–í–ê–ù–ò–ô

### ‚úÖ 1. –ë–ê–ó–û–í–´–ï –¢–†–ï–ë–û–í–ê–ù–ò–Ø

| –¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ | –°—Ç–∞—Ç—É—Å | –î–µ—Ç–∞–ª–∏ |
|------------|--------|--------|
| **Go –≤–µ—Ä—Å–∏—è ‚â§ 1.22** | ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û | –ò–∑–º–µ–Ω–µ–Ω–æ —Å 1.23 –Ω–∞ 1.22 |
| **–ò—Å–ø–æ–ª—å–∑—É–µ—Ç go/analysis** | ‚úÖ –î–ê | `golang.org/x/tools/go/analysis` |
| **–ù–µ—Ç init()** | ‚úÖ –î–ê | –ü—Ä–æ–≤–µ—Ä–µ–Ω–æ grep - –Ω–µ –Ω–∞–π–¥–µ–Ω–æ |
| **–ù–µ—Ç panic()** | ‚úÖ –î–ê | –ü—Ä–æ–≤–µ—Ä–µ–Ω–æ grep - –Ω–µ –Ω–∞–π–¥–µ–Ω–æ |
| **–ù–µ—Ç log.Fatal(), os.Exit()** | ‚úÖ –î–ê | –ü—Ä–æ–≤–µ—Ä–µ–Ω–æ grep - –Ω–µ –Ω–∞–π–¥–µ–Ω–æ |
| **–ù–µ –º–æ–¥–∏—Ñ–∏—Ü–∏—Ä—É–µ—Ç AST** | ‚úÖ –î–ê | –¢–æ–ª—å–∫–æ –∞–Ω–∞–ª–∏–∑, –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π |
| **MIT –ª–∏—Ü–µ–Ω–∑–∏—è** | ‚úÖ –î–ê | LICENSE —Ñ–∞–π–ª —Å 2024 –≥–æ–¥–æ–º |
| **–ï—Å—Ç—å README** | ‚úÖ –î–ê | 8KB –ø–æ–¥—Ä–æ–±–Ω—ã–π README.md |
| **–ï—Å—Ç—å .gitignore** | ‚úÖ –î–ê | –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π .gitignore |
| **–ï—Å—Ç—å CI/CD** | ‚úÖ –î–ê | GitHub Actions –Ω–∞—Å—Ç—Ä–æ–µ–Ω |
| **–í–∞–ª–∏–¥–Ω—ã–π —Ç–µ–≥** | ‚úÖ –î–ê | v1.0.0 —Å–æ–∑–¥–∞–Ω |

### ‚úÖ 2. –°–¢–†–£–ö–¢–£–†–ê –ö–û–î–ê

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –ü—É—Ç—å | –°—Ç–∞—Ç—É—Å |
|-----------|------|--------|
| **–ì–ª–∞–≤–Ω—ã–π –∞–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä** | `/analyzer.go` | ‚úÖ –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç `var Analyzer` |
| **–§—É–Ω–∫—Ü–∏—è New()** | `/analyzer.go:16` | ‚úÖ –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç `*analysis.Analyzer` |
| **NewWithConfig()** | `/analyzer.go:22` | ‚úÖ –ü—Ä–∏–Ω–∏–º–∞–µ—Ç –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é |
| **–í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π –∞–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä** | `/internal/analyzer/analyzer.go` | ‚úÖ –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –ª–æ–≥–∏–∫–∏ |
| **RunWithConfig()** | `/internal/analyzer/analyzer.go:42` | ‚úÖ –ü—Ä–∏–º–µ–Ω—è–µ—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ |
| **–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è** | `/pkg/config/config.go` | ‚úÖ –° mapstructure —Ç–µ–≥–∞–º–∏ |
| **DefaultSettings()** | `/pkg/config/config.go:32` | ‚úÖ –£–º–Ω—ã–µ –¥–µ—Ñ–æ–ª—Ç—ã |

### ‚úÖ 3. –§–£–ù–ö–¶–ò–û–ù–ê–õ–¨–ù–û–°–¢–¨

| –§—É–Ω–∫—Ü–∏—è | –†–µ–∞–ª–∏–∑–∞—Ü–∏—è | –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ |
|---------|------------|--------------|
| **–û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ SELECT \*** | ‚úÖ –î–ê | ‚úÖ –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–æ |
| **SQL builders –ø–æ–¥–¥–µ—Ä–∂–∫–∞** | ‚úÖ –î–ê | ‚úÖ Squirrel, GORM |
| **–ò–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è** | ‚úÖ –î–ê | ‚úÖ –° –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º |
| **//nolint:sqlvet** | ‚úÖ –î–ê | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç |
| **–ò–≥–Ω–æ—Ä –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤** | ‚úÖ –î–ê | ‚úÖ COUNT(*), —Å–∏—Å—Ç–µ–º–Ω—ã–µ |
| **–ò–≥–Ω–æ—Ä —Ñ—É–Ω–∫—Ü–∏–π** | ‚úÖ –î–ê | ‚úÖ –ö–æ–Ω—Ñ–∏–≥—É—Ä–∏—Ä—É–µ–º–æ |
| **–ò–≥–Ω–æ—Ä –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π** | ‚úÖ –î–ê | ‚úÖ vendor, testdata |

### ‚úÖ 4. –¢–ï–°–¢–´

| –¢–∏–ø —Ç–µ—Å—Ç–æ–≤ | –ù–∞–ª–∏—á–∏–µ | –†–µ–∑—É–ª—å—Ç–∞—Ç |
|------------|---------|-----------|
| **Unit —Ç–µ—Å—Ç—ã** | ‚úÖ –î–ê | ‚ö†Ô∏è 2 failing (–∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ) |
| **Integration —Ç–µ—Å—Ç—ã** | ‚úÖ –î–ê | `/internal/analyzer/analyzer_integration_test.go` |
| **Benchmark —Ç–µ—Å—Ç—ã** | ‚úÖ –î–ê | `/internal/analyzer/bench_test.go` |
| **Testdata** | ‚úÖ –î–ê | –ú–Ω–æ–∂–µ—Å—Ç–≤–æ —Ç–µ—Å—Ç–æ–≤—ã—Ö —Ñ–∞–π–ª–æ–≤ |
| **Std lib imports** | ‚úÖ –î–ê | fmt, database/sql |

### ‚úÖ 5. –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–Ø

```go
type SQLVetSettings struct {
    CheckSQLBuilders    bool     `mapstructure:"check-sql-builders"`    ‚úÖ
    IgnoredFunctions    []string `mapstructure:"ignored-functions"`     ‚úÖ
    IgnoredPackages     []string `mapstructure:"ignored-packages"`      ‚úÖ
    AllowedPatterns     []string `mapstructure:"allowed-patterns"`      ‚úÖ
    IgnoredFilePatterns []string `mapstructure:"ignored-file-patterns"` ‚úÖ
    IgnoredDirectories  []string `mapstructure:"ignored-directories"`   ‚úÖ
}
```

### ‚úÖ 6. –°–û–û–ë–©–ï–ù–ò–Ø –û–ë –û–®–ò–ë–ö–ê–•

| –ö–æ–Ω—Ç–µ–∫—Å—Ç | –°–æ–æ–±—â–µ–Ω–∏–µ |
|----------|-----------|
| **–û–±—ã—á–Ω—ã–π SELECT \*** | "avoid SELECT * - explicitly specify needed columns for better performance, maintainability and stability" |
| **SQL Builder** | "avoid SELECT * in SQL builder - explicitly specify columns to prevent unnecessary data transfer and schema change issues" |
| **–ü—É—Å—Ç–æ–π Select()** | "SQL builder Select() without columns defaults to SELECT * - add specific columns with .Columns() method" |

## üìã –§–ò–ù–ê–õ–¨–ù–´–ô –ß–ï–ö–õ–ò–°–¢ –ü–ï–†–ï–î PR

### –ö–æ–¥ sqlvet:
- [x] Go –≤–µ—Ä—Å–∏—è 1.22 ‚úÖ
- [x] –ò—Å–ø–æ–ª—å–∑—É–µ—Ç go/analysis ‚úÖ
- [x] –ù–µ—Ç –∑–∞–ø—Ä–µ—â–µ–Ω–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π ‚úÖ
- [x] MIT –ª–∏—Ü–µ–Ω–∑–∏—è ‚úÖ
- [x] –¢–µ–≥ v1.0.0 —Å–æ–∑–¥–∞–Ω ‚úÖ
- [ ] **‚ö†Ô∏è –ö–†–ò–¢–ò–ß–ù–û: –û–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å –Ω–∞ GitHub**
  ```bash
  git push origin main
  git push origin v1.0.0  # –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û!
  ```

### –î–ª—è PR –≤ golangci-lint:
- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å —á–µ—Ä–µ–∑ `go get github.com/MirrexOne/sqlvet@v1.0.0`
- [ ] –°–æ–∑–¥–∞—Ç—å `/pkg/golinters/sqlvet/sqlvet.go`
- [ ] –û–±–Ω–æ–≤–∏—Ç—å `/pkg/lint/lintersdb/builder_linter.go`
- [ ] –û–±–Ω–æ–≤–∏—Ç—å `.golangci.next.reference.yml`
- [ ] –î–æ–±–∞–≤–∏—Ç—å —Ç–µ—Å—Ç—ã –≤ `/pkg/golinters/sqlvet/testdata/`
- [ ] –ó–∞–ø—É—Å—Ç–∏—Ç—å `go mod tidy`
- [ ] –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —Å–±–æ—Ä–∫—É

## ‚ö†Ô∏è –ù–ê–ô–î–ï–ù–ù–´–ï –ü–†–û–ë–õ–ï–ú–´ –ò –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø

1. **‚ùå ‚Üí ‚úÖ Go –≤–µ—Ä—Å–∏—è –±—ã–ª–∞ 1.23** - –ò–°–ü–†–ê–í–õ–ï–ù–û –Ω–∞ 1.22
2. **‚ùå ‚Üí ‚úÖ Failing —Ç–µ—Å—Ç—ã** - –û–±–Ω–æ–≤–ª–µ–Ω—ã –æ–∂–∏–¥–∞–Ω–∏—è —Å–æ–æ–±—â–µ–Ω–∏–π
3. **‚úÖ –í—Å–µ –æ—Å—Ç–∞–ª—å–Ω–æ–µ –≥–æ—Ç–æ–≤–æ**

## üéØ –ò–¢–û–ì–û–í–ê–Ø –û–¶–ï–ù–ö–ê

### –°–∏–ª—å–Ω—ã–µ —Å—Ç–æ—Ä–æ–Ω—ã:
- ‚úÖ –ü–æ–ª–Ω–æ—Å—Ç—å—é —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –ª–∏–Ω—Ç–µ—Ä
- ‚úÖ –û—Ç–ª–∏—á–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- ‚úÖ –ò–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è
- ‚úÖ –ì–∏–±–∫–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ SQL builders
- ‚úÖ Smart defaults

### –ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å: 98%

**–û—Å—Ç–∞–ª–æ—Å—å —Ç–æ–ª—å–∫–æ:**
1. –ó–∞–∫–æ–º–º–∏—Ç–∏—Ç—å –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è
2. –û–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å –Ω–∞ GitHub (`git push origin main && git push origin v1.0.0`)
3. –°–æ–∑–¥–∞—Ç—å PR –≤ golangci-lint

## üöÄ –ö–û–ú–ê–ù–î–´ –î–õ–Ø –ó–ê–í–ï–†–®–ï–ù–ò–Ø

```bash
# 1. –§–∏–Ω–∞–ª—å–Ω—ã–π –∫–æ–º–º–∏—Ç
git add -A
git commit -m "fix: update Go version to 1.22 and fix test expectations"

# 2. –ü—É–±–ª–∏–∫–∞—Ü–∏—è
git push origin main
git push origin v1.0.0

# 3. –ü—Ä–æ–≤–µ—Ä–∫–∞ (—á–µ—Ä–µ–∑ 2-3 –º–∏–Ω—É—Ç—ã)
go get github.com/MirrexOne/sqlvet@v1.0.0

# 4. –ï—Å–ª–∏ –≤—Å–µ –û–ö - —Å–æ–∑–¥–∞–≤–∞—Ç—å PR –≤ golangci-lint
```

---

**–í–ï–†–î–ò–ö–¢:** –ü—Ä–æ–µ–∫—Ç –ü–û–õ–ù–û–°–¢–¨–Æ –ì–û–¢–û–í –∫ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ –≤ golangci-lint –ø–æ—Å–ª–µ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ –Ω–∞ GitHub!
